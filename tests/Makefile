CC = clang
CFLAGS = -Wall -Wextra -std=c11 -g -D_POSIX_C_SOURCE=200809L
LDFLAGS = -pthread

# Test targets
TEST_ULA_SOURCE = test_ula.c
TEST_ULA_EXECUTABLE = test_ula
TEST_Z80_SOURCE = test_z80.c
TEST_Z80_EXECUTABLE = test_z80

all: $(TEST_ULA_EXECUTABLE) $(TEST_Z80_EXECUTABLE)

$(TEST_ULA_EXECUTABLE): $(TEST_ULA_SOURCE)
	$(CC) $(CFLAGS) $(LDFLAGS) -o $(TEST_ULA_EXECUTABLE) $(TEST_ULA_SOURCE)

$(TEST_Z80_EXECUTABLE): $(TEST_Z80_SOURCE)
	$(CC) $(CFLAGS) $(LDFLAGS) -o $(TEST_Z80_EXECUTABLE) $(TEST_Z80_SOURCE)

run: all
	./$(TEST_ULA_EXECUTABLE)
	./$(TEST_Z80_EXECUTABLE)

run-ula: $(TEST_ULA_EXECUTABLE)
	./$(TEST_ULA_EXECUTABLE)

run-z80: $(TEST_Z80_EXECUTABLE)
	./$(TEST_Z80_EXECUTABLE)

clean:
	rm -f $(TEST_ULA_EXECUTABLE) $(TEST_Z80_EXECUTABLE) *.o

.PHONY: all run run-ula run-z80 clean
